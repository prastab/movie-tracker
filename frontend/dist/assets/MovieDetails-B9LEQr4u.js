import{d as P,u as T,r as n,l as U,j as z,m as L,n as Y,c as i,b as p,a as t,t as r,p as M,k as R,F as j,q as A,f as q,s as K,g as G,x as H,y as I,z as J,A as S,B as O,h as Q,o}from"./index-iPCQyBz-.js";import{_ as X}from"./RatingStars.vue_vue_type_script_setup_true_lang-D2LJJO6z.js";const Z={class:"relative min-h-screen bg-gray-900 bg-background text-foreground"},tt={key:0,class:"absolute top-0 left-0 w-full h-screen z-10"},et=["src"],st={key:1,class:"flex items-center justify-center min-h-screen"},at={key:2,class:"flex flex-col items-center justify-center min-h-screen gap-4"},lt={class:"text-lg"},ot={key:3,class:"relative z-20 max-w-[1400px] mx-auto px-5 py-24"},it={class:"flex flex-col items-center justify-center md:flex-row gap-8 md:gap-12 mb-16"},rt={class:"mx-auto md:mx-0 md:flex-shrink-0"},nt=["src","alt"],ct={class:"flex-grow pt-5"},dt={class:"text-4xl md:text-5xl font-bold mb-6 leading-tight text-center"},ut={class:"flex items-center justify-center gap-3 text-lg mb-6"},mt={class:"text-sm text-muted-foreground"},vt={class:"flex items-center gap-1"},gt={class:"flex flex-wrap justify-center gap-2 mb-8"},pt={class:"text-lg leading-relaxed text-muted-foreground max-w-3xl mb-8"},ht={class:"flex flex-col md:flex-row items-center gap-6 justify-center"},ft={class:"flex items-center gap-4"},_t={key:0,class:"text-red-500 text-sm"},xt={class:"flex items-center gap-4"},bt=["disabled"],yt={class:"text-lg font-bold"},wt={key:0,class:"mb-16"},kt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-6 md:gap-8"},$t={class:"aspect-square rounded-full overflow-hidden mb-3"},Rt=["src","alt"],jt={key:1,class:"w-full h-full bg-gray-700 flex items-center justify-center text-3xl"},At={class:"text-center"},Ct={class:"font-semibold mb-1"},Wt={class:"text-sm text-gray-400"},Dt={key:1,class:"mb-16"},Ft={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 md:gap-8"},Mt=["onClick"],St=["src","alt"],Vt={class:"font-semibold mb-1"},Bt={class:"text-sm text-gray-400"},C="https://api.themoviedb.org/3",Tt=P({__name:"MovieDetails",setup(Et){const h=z(),c=T(),l=n(null),f=n([]),_=n([]),x=n(!0),b=n(""),m=n(0),v=n(!1),d=n(""),u=n(!1),y=n(!1),w="fd67da597c4cf7b23c2434f79fd181e2",W=async s=>{if(c.isAuthenticated)try{const e=await H(Number(s));u.value=e}catch(e){console.error("Error checking watchlist status:",e)}},V=async()=>{if(!(!c.isAuthenticated||!l.value)){y.value=!0;try{u.value?(await I(l.value.id),u.value=!1):(await J(l.value.id),u.value=!0)}catch(s){console.error("Error updating watchlist:",s)}finally{y.value=!1}}},k=async s=>{try{const[e,$,g]=await Promise.all([fetch(`${C}/movie/${s}?api_key=${w}`),fetch(`${C}/movie/${s}/credits?api_key=${w}`),fetch(`${C}/movie/${s}/similar?api_key=${w}`)]),a=await e.json(),D=await $.json(),N=await g.json();l.value={...a,poster_path:`https://image.tmdb.org/t/p/w342${a.poster_path}`},f.value=D.cast.slice(0,8),_.value=N.results.slice(0,4).map(F=>({...F,poster_path:`https://image.tmdb.org/t/p/w185${F.poster_path}`}))}catch{b.value="Failed to load movie details. Please try again."}finally{x.value=!1}},B=async s=>{if(!(!c.isAuthenticated||!l.value)){v.value=!0,d.value="";try{s===0?await S(l.value.id):await O(l.value.id,s),m.value=s}catch(e){console.error("Rating error:",e),d.value="Failed to update rating"}finally{v.value=!1}}},E=async()=>{if(!(!c.isAuthenticated||!l.value)){v.value=!0,d.value="";try{await S(l.value.id),m.value=0}catch(s){console.error("Rating removal error:",s),d.value="Failed to remove rating"}finally{v.value=!1}}};return U(async()=>{const s=h.params.id;s&&await Promise.all([k(s),W(s),c.isAuthenticated&&L(Number(s)).then(e=>m.value=e.rating)])}),Y(()=>h.params.id,async s=>{s&&(x.value=!0,await Promise.all([k(s),W(s)]),window.scrollTo(0,0))}),(s,e)=>{var g;const $=Q("router-link");return o(),i("div",Z,[(g=l.value)!=null&&g.backdrop_path?(o(),i("div",tt,[t("img",{src:`https://image.tmdb.org/t/p/original${l.value.backdrop_path}`,alt:"backdrop",class:"w-full h-full object-cover"},null,8,et),e[2]||(e[2]=t("div",{class:"absolute inset-0 bg-gradient-to-b from-[rgba(20,20,20,0.75)] to-[#141414]"},null,-1))])):p("",!0),x.value?(o(),i("div",st,e[3]||(e[3]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-white border-t-transparent"},null,-1)]))):b.value?(o(),i("div",at,[t("p",lt,r(b.value),1),t("button",{onClick:e[0]||(e[0]=a=>k(M(h).params.id)),class:"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors"}," Try Again ")])):(o(),i("div",ot,[t("div",it,[t("div",rt,[t("img",{src:l.value.poster_path,alt:l.value.title,class:"w-full md:w-[400px] rounded-2xl shadow-2xl border-4 border-white/30"},null,8,nt)]),t("div",ct,[t("h1",dt,r(l.value.title),1),t("div",ut,[t("span",mt,r(new Date(l.value.release_date).getFullYear()),1),e[5]||(e[5]=t("span",{class:"text-gray-500"},"•",-1)),t("span",null,r(Math.floor(l.value.runtime/60))+"h "+r(l.value.runtime%60)+"m",1),e[6]||(e[6]=t("span",{class:"text-gray-500"},"•",-1)),t("div",vt,[e[4]||(e[4]=t("span",{class:"text-yellow-400"},"★",-1)),R(" "+r(Math.round(l.value.vote_average*10)/10),1)])]),t("div",gt,[(o(!0),i(j,null,A(l.value.genres,a=>(o(),i("span",{key:a.id,class:"bg-muted/10 px-4 py-1.5 rounded-full text-sm"},r(a.name),1))),128))]),t("p",pt,r(l.value.overview),1),t("div",ht,[t("div",ft,[e[7]||(e[7]=t("span",{class:"text-gray-300"},"Rate:",-1)),q(X,{modelValue:m.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>m.value=a),B],size:"lg",disabled:v.value,"show-remove-button":!0,onRemove:E},null,8,["modelValue","disabled"]),d.value?(o(),i("span",_t,r(d.value),1)):p("",!0)]),t("div",xt,[M(c).isAuthenticated?(o(),i("button",{key:0,onClick:V,disabled:y.value,class:"flex items-center gap-2 bg-red-600 hover:bg-red-700 px-6 py-3 rounded-xl font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[t("span",yt,r(u.value?"✓":"+"),1),R(" "+r(u.value?"In Watchlist":"Add to Watchlist"),1)],8,bt)):(o(),K($,{key:1,to:"/login",class:"flex items-center gap-2 bg-white-600 hover:bg-white-700 px-6 py-3 rounded-xl font-semibold transition-colors"},{default:G(()=>e[8]||(e[8]=[R(" Login to add to watchlist ")])),_:1}))])])])]),f.value.length?(o(),i("section",wt,[e[9]||(e[9]=t("h2",{class:"text-3xl font-semibold mb-8"},"Top Cast",-1)),t("div",kt,[(o(!0),i(j,null,A(f.value,a=>(o(),i("div",{key:a.id,class:"group transition-transform hover:-translate-y-1"},[t("div",$t,[a.profile_path?(o(),i("img",{key:0,src:`https://image.tmdb.org/t/p/w200${a.profile_path}`,alt:a.name,class:"w-full h-full object-cover"},null,8,Rt)):(o(),i("div",jt,r(a.name[0]),1))]),t("div",At,[t("h3",Ct,r(a.name),1),t("p",Wt,r(a.character),1)])]))),128))])])):p("",!0),_.value.length?(o(),i("section",Dt,[e[10]||(e[10]=t("h2",{class:"text-3xl font-semibold mb-8"},"Similar Movies",-1)),t("div",Ft,[(o(!0),i(j,null,A(_.value,a=>(o(),i("div",{key:a.id,onClick:D=>s.$router.push(`/movies/${a.id}`),class:"cursor-pointer group transition-transform hover:-translate-y-1"},[t("img",{src:a.poster_path,alt:a.title,class:"w-full aspect-[2/3] rounded-xl mb-3"},null,8,St),t("div",null,[t("h3",Vt,r(a.title),1),t("span",Bt,r(new Date(a.release_date).getFullYear()),1)])],8,Mt))),128))])])):p("",!0)]))])}}});export{Tt as default};
